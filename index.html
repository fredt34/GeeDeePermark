<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>GeeDeePermark - File Watermarking</title>\n    <link rel="stylesheet" href="style.css">\n</head>\n<body>\n    <div class="container">\n        <h1 id="app-title">GeeDeePermark Watermarking</h1>\n        <p class="details" id="app-details">Upload your file to add a watermark</p>\n        \n        <div class="upload-area" id="uploadArea">\n            <div class="upload-icon">üìÅ</div>\n            <p>Click to select a file or drag and drop</p>\n            <p style="font-size: 14px; color: #666; margin-top: 10px;">Supports images and PDF files</p>\n            <input type="file" id="fileInput" class="file-input" accept="image/*,.pdf">\n        </div>\n\n        <div class="file-info" id="fileInfo">\n            <div class="file-name" id="fileName"></div>\n            <div class="file-size" id="fileSize"></div>\n        </div>\n\n        <button class="btn" id="uploadBtn" disabled>Upload and Watermark</button>\n\n        <div class="status" id="status"></div>\n    </div>\n\n    <script>\n        let selectedFile = null;\n        let config = {};\n\n        // Load configuration\n        async function loadConfig() {\n            try {\n                const response = await fetch('parameters.json');\n                config = await response.json();\n                document.getElementById('app-title').textContent = config.title || 'GeeDeePermark Watermarking';\n                document.getElementById('app-details').textContent = config.details || 'Upload your file to add a watermark';\n            } catch (error) {\n                console.error('Error loading config:', error);\n                showStatus('Error loading configuration', 'error');\n            }\n        }\n\n        // DOM elements\n        const uploadArea = document.getElementById('uploadArea');\n        const fileInput = document.getElementById('fileInput');\n        const fileInfo = document.getElementById('fileInfo');\n        const fileName = document.getElementById('fileName');\n        const fileSize = document.getElementById('fileSize');\n        const uploadBtn = document.getElementById('uploadBtn');\n        const status = document.getElementById('status');\n\n        // Event listeners\n        uploadArea.addEventListener('click', () => fileInput.click());\n        fileInput.addEventListener('change', handleFileSelect);\n        uploadBtn.addEventListener('click', uploadFile);\n\n        // Drag and drop\n        uploadArea.addEventListener('dragover', (e) => {\n            e.preventDefault();\n            uploadArea.classList.add('dragover');\n        });\n\n        uploadArea.addEventListener('dragleave', () => {\n            uploadArea.classList.remove('dragover');\n        });\n\n        uploadArea.addEventListener('drop', (e) => {\n            e.preventDefault();\n            uploadArea.classList.remove('dragover');\n            const files = e.dataTransfer.files;\n            if (files.length > 0) {\n                handleFile(files[0]);\n            }\n        });\n\n        function handleFileSelect(e) {\n            const files = e.target.files;\n            if (files.length > 0) {\n                handleFile(files[0]);\n            }\n        }\n\n        function handleFile(file) {\n            selectedFile = file;\n            fileName.textContent = file.name;\n            fileSize.textContent = formatFileSize(file.size);\n            fileInfo.classList.add('show');\n            uploadBtn.disabled = false;\n            status.classList.remove('show');\n        }\n\n        function formatFileSize(bytes) {\n            if (bytes === 0) return '0 Bytes';\n            const k = 1024;\n            const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n            const i = Math.floor(Math.log(bytes) / Math.log(k));\n            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];\n        }\n\n        function showStatus(message, type) {\n            status.textContent = message;\n            status.className = 'status show ' + type;\n        }\n\n        async function uploadFile() {\n            if (!selectedFile) return;\n\n            const apiUrl = config.url || 'https://geedeepermark.cpvo.org/watermark';\n            const configId = config.config || '0012-1234-...';\n\n            uploadBtn.disabled = true;\n            showStatus('Uploading and watermarking... ', 'loading');\n            status.innerHTML = '<span class="spinner"></span> Uploading and watermarking...';\n\n            try {\n                const formData = new FormData();\n                formData.append('file', selectedFile);\n                formData.append('config', configId);\n\n                const response = await fetch(apiUrl, {\n                    method: 'POST',\n                    body: formData\n                });\n\n                if (!response.ok) {\n                    throw new Error(`Server responded with ${response.status}: ${response.statusText}`);\n                }\n\n                // Get the watermarked file\n                const blob = await response.blob();\n                const url = window.URL.createObjectURL(blob);\n                \n                // Determine file extension from original file or response\n                const contentType = response.headers.get('content-type');\n                let extension = selectedFile.name.split('.').pop();\n                \n                // Create download link\n                const downloadLink = document.createElement('a');\n                downloadLink.href = url;\n                downloadLink.download = `watermarked_${selectedFile.name}`;\n                downloadLink.className = 'download-link';\n                downloadLink.textContent = 'üì• Download Watermarked File';\n                \n                status.innerHTML = '‚úÖ Watermarking successful! ';\n                status.appendChild(downloadLink);\n                status.className = 'status show success';\n\n                // Auto-download\n                downloadLink.click();\n\n            } catch (error) {\n                console.error('Upload error:', error);\n                showStatus(`‚ùå Error: ${error.message}`, 'error');\n            } finally {\n                uploadBtn.disabled = false;\n            }\n        }\n\n        // Initialize\n        loadConfig();\n    </script>\n</body>\n</html>